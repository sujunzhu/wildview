{{define "content"}}
<form id="search-form" onsubmit="return false">
  <input name="search" />
  <input type="submit" value="Search" onclick="submitSearch()" />
</form>

<table width="100%">
  <thead>
    <tr style="text-align: left;">
      <th width="50%">Name</th>
      <th width="50%">Price</th>
    </tr>
  </thead>
  <tbody id="search-results">
  </tbody>
</table>

<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript">
  function submitSearch() {
    $.ajax({
      url: "/product/",
      method: "POST",
      data: $("#search-form").serialize(),
      success: function(rawData) {
        var parsed = JSON.parse(rawData);
        if (!parsed) return;

        var searchResults = $("#search-results");
        searchResults.empty();

        parsed.forEach(function(result) {
          var row = $("<tr><td>" + result.Name + "</td><td>" + result.Price + "</td></tr>");
          searchResults.append(row);
          row.on("click", function() {
            $.ajax({
              url: "/product/",
              method: "PUT",
              success: function(data){
                var product = JSON.parse(data);
                if (!product) return;
              }
            })
          })
        });
      }
    });

    return false;
  }
</script>
{{end}}
